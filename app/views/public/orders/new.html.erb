<%= render 'layouts/customer_header' %>
<h1>注文情報入力</h1>

<table>
	<tr>
		<th>商品名</th>
		<th>単価</th>
		<th>数量</th>
		<th>小計</th>
		<th></th>
	</tr>
	<tr>
		<!-- @sumに０を代入 -->
		<% @sum = 0%>
		<!-- @cartsにはCurtItemモデルの全てを代入してある -->
		<% current_customer.cart_items.each do |c|%>
		<!-- カート内の商品名を表示 -->
		<td><%= c.item.name%></td>
		<!-- カート内の商品の値段を表示 -->
		<td><%= c.item.price%></td>
		<td><%= c.amount%></td>
		<!-- @totalにpriceをamountの乗算を代入 -->
		<% @total = c.item.price * c.amount%>
		<!-- @totalを表示 -->
		<!-- カート内の商品の値段と個数を乗算した小計を表示 -->
		<td><%= @total %></td>
		<!-- @sumに@totalの値を加算 -->
		<!-- @sumにtotalpeiceが繰り返し処理される -->
		<% @sum += @total %>
	</tr>
		<% end %>
</table>
<%= form_for(@order, url: public_orders_path) do |f| %>
    <%= current_customer.address %>
    <%= current_customer.first_name%><%= current_customer.last_name%>
	<h2>配送料</h2>
		<% @delivery = 500 %>
		<%= @delivery %>円

	<h2>請求額</h2>
		<!-- @sumが商品合計額 -->
		<!-- @deliveryが配送料（500円） -->
		<%= @sum + @delivery %>円
		<% @totals = @sum + @delivery %>円

	<h2>支払い方法</h2>
	<h3>クレジットカード</h3>
	<!-- eunmで定義[0]がクレジットカード -->
		<%= f.radio_button :payment_method, ['クレジットカード'] %>
	<h3>銀行</h3>
		<!-- eunmで定義[1]が銀行 -->
		<%= f.radio_button :payment_method, ['銀行'] %>
	<%= f.hidden_field :customer_id, :value => current_customer.id %>
	<%= f.hidden_field :address, :value => current_customer.address %>
	<%= f.hidden_field :postal_code, :value => current_customer.postal_code %>
	<%= f.hidden_field :name, :value => current_customer.first_name %>
	<!-- shipping_costを代入 -->
	<%= f.hidden_field :shipping_cost, :value => @delivery %>
	<!-- 初期ステータスを代入 -->
	<%= f.hidden_field :status, :value => ['入金待ち'] %>
	<!-- トータル金額をデータ代入 -->
	<%= f.hidden_field :total_payment, :value => @totals %>

	<!-- 上記のデータをorder :createに送信 -->
	<%= f.submit %>
<% end %>